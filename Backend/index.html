<!doctype html>
<html>
<head><meta charset="utf-8"><title>Mini Online Editor</title></head>
<body>
  <h3>Mini Editor (Code + Input)</h3>
  <select id="lang"></select><br/>
  <textarea id="code" rows="8" cols="60">print("Hello from Python")</textarea><br/>
  <textarea id="stdin" rows="3" cols="60" placeholder="User input (stdin)"></textarea><br/>
  <button id="run">Run</button>
  <pre id="out"></pre>

<script>
async function loadLanguages(){
  const r = await fetch('/api/languages'); // your express server endpoint
  const langs = await r.json();
  const sel = document.getElementById('lang');
  langs.forEach(l => {
    const opt = document.createElement('option');
    opt.value = l.id;
    opt.textContent = `${l.id} â€” ${l.name}`;
    sel.appendChild(opt);
  });
}
document.getElementById('run').addEventListener('click', async () => {
  const code = document.getElementById('code').value;
  const language_id = Number(document.getElementById('lang').value);
  const stdin = document.getElementById('stdin').value;
  document.getElementById('out').textContent = 'Running...';
  // Use /api/run for convenience (blocks until result), or use /api/submit + poll /api/result/:token
  const r = await fetch('/api/run', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({source_code: code, language_id, stdin})
  });
  const data = await r.json();
  document.getElementById('out').textContent = JSON.stringify(data, null, 2);
});
loadLanguages();
</script>
</body>
</html>
