<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Python Editor + AI Chatbot</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- CodeMirror CSS & JS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>

  <style>
    html, body {
      height: 100%;
      margin: 0;
    }
    .CodeMirror {
      height: 80%; /* Full height editor */
      border-radius: 0.5rem;
      font-size: 14px;
    }
  </style>
</head>
<body class="h-full bg-gray-100">

  <div class="flex h-full min-h-screen">
    <!-- Left: Python Editor -->
    <div class="flex-1 p-4 flex flex-col">
      <textarea id="code">

def factorial(n):
    if n==0 or n==1:
        return 1
    return n*factorial(n-1)

def fibonacci(n):
    seq=[0,1]
    for i in range(2,n):
        seq.append(seq[-1]+seq[-2])
    return seq

def prime_numbers(limit):
    primes=[]
    for num in range(2,limit+1):
        is_prime=True
        for i in range(2,int(num**0.5)+1):
            if num%i==0:
                is_prime=False
                break
        if is_prime:
            primes.append(num)
    return primes

print("=== Python Demo Program ===")
print("Factorial of 6:", factorial(6))
print("First 10 Fibonacci numbers:", fibonacci(10))
print("Prime numbers up to 50:", prime_numbers(50))
      </textarea>
      
      <div class="flex mt-4 space-x-4">
        <button onclick="runCode()" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Run Code</button>
        <button onclick="clearOutput()" class="px-6 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">Clear Output</button>
      </div>

      <h3 class="mt-4 font-semibold text-lg">Output:</h3>
      <pre id="output" class="bg-gray-900 text-green-400 p-4 rounded flex-1 overflow-auto"></pre>
    </div>

    <!-- Right: AI Chatbot Panel -->
    <div class="w-1/5 bg-white p-4 border-l border-gray-300 flex flex-col">
      <h2 class="text-xl font-bold mb-2 text-center">AI Chatbot</h2>
      <div id="chatOutput" class="flex-1 bg-gray-100 p-2 rounded overflow-auto mb-2">
        <p class="text-gray-500 text-sm">Chat output will appear here...</p>
      </div>
      <input id="chatInput" type="text" placeholder="Type your query..." class="p-2 border rounded mb-2">
      <button onclick="sendChat()" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">Send</button>
    </div>
  </div>

  <script>
    // Initialize CodeMirror
    const editor = CodeMirror.fromTextArea(document.getElementById("code"), {
      mode: "python",
      theme: "dracula",
      lineNumbers: true,
      matchBrackets: true,
      autoCloseBrackets: true,
      indentUnit: 4,
      tabSize: 4
    });

    async function runCode() {
      const code = editor.getValue();

      const response = await fetch("https://emkc.org/api/v2/piston/execute", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          language: "python",
          version: "3.10.0",
          files: [{ name: "main.py", content: code }]
        })
      });

      const data = await response.json();
      document.getElementById("output").innerText =
        (data.run.output || "") + (data.run.stderr || "");
    }

    function clearOutput() {
      document.getElementById("output").innerText = "";
    }

    function sendChat() {
      const input = document.getElementById("chatInput").value;
      if(input.trim() === "") return;

      const chatDiv = document.getElementById("chatOutput");
      const p = document.createElement("p");
      p.className = "text-gray-800 mb-1";
      p.textContent = "You: " + input;
      chatDiv.appendChild(p);

      // Example AI response (placeholder)
      const aiP = document.createElement("p");
      aiP.className = "text-blue-600 mb-2";
      aiP.textContent = "AI: This is a placeholder response.";
      chatDiv.appendChild(aiP);

      chatDiv.scrollTop = chatDiv.scrollHeight; // scroll to bottom
      document.getElementById("chatInput").value = "";
    }
  </script>

</body>
</html>
